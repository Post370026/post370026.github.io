<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å pdfmake</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.min.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        :root {
            --bg-color: #f9fafb;
            --text-color: #111827;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --primary-color: #3b82f6;
            --hover-color: #2563eb;
        }

        [data-theme="dark"] {
            --bg-color: #111827;
            --text-color: #f9fafb;
            --card-bg: #1f2937;
            --border-color: #374151;
            --primary-color: #60a5fa;
            --hover-color: #93c5fd;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: var(--hover-color);
        }

        button.outline {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        button.outline:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .tab.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }

        textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg);
            color: var(--text-color);
            font-family: inherit;
            font-size: 16px;
            resize: vertical;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #10b981;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.error {
            background-color: #ef4444;
        }

        .info-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--primary-color);
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .buttons {
                width: 100%;
            }
            
            button {
                flex: 1;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>–í–∏—Ç—Ä–∏–Ω–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ</h1>
                <p id="portfolio-id">ID: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
            <div class="buttons">
                <button id="theme-toggle" class="outline">üåô –°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</button>
                <button id="preview-toggle" class="outline">üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
                <button id="share-btn" class="outline">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                <button id="download-pdf">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>
            </div>
        </div>

        <div id="notification" class="notification" style="display: none;"></div>

        <div class="tabs">
            <div class="tab active" data-tab="article">–°—Ç–∞—Ç—å—è</div>
            <div class="tab" data-tab="card">–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞</div>
            <div class="tab" data-tab="landing">–õ–µ–Ω–¥–∏–Ω–≥</div>
            <div class="tab" data-tab="social">–°–æ—Ü—Å–µ—Ç–∏</div>
            <div class="tab" data-tab="email">Email</div>
        </div>

        <div class="card">
            <div id="preview-content" style="display: none;">
                <h3 id="preview-title"></h3>
                <p id="preview-text" style="white-space: pre-line;"></p>
            </div>
            <textarea id="content-editor" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç..."></textarea>
        </div>

        <div class="info-box">
            <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?</h3>
            <p>1. –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤—ã—à–µ</p>
            <p>2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ</p>
            <p>3. –ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å PDF" —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</p>
            <p>4. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</p>
        </div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            darkMode: false,
            previewMode: false,
            activeTab: 'article',
            portfolioId: generateId(),
            content: {
                article: { title: "–ù–∞—Ç–∏–≤–Ω–∞—è —Å—Ç–∞—Ç—å—è", text: "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã 2025 –≥–æ–¥–∞: –Ω–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–≥–æ—Ä–µ—Ç—å..." },
                card: { title: "–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞", text: "Oppo Reno 14 Pro ‚Äî 3√ó50 –ú–ü –∫–∞–º–µ—Ä—ã, —ç–∫—Ä–∞–Ω 120 –ì—Ü, –±–∞—Ç–∞—Ä–µ—è 6200 –º–ê—á..." },
                landing: { title: "–õ–µ–Ω–¥–∏–Ω–≥", text: "Realme GT 6 Pro. –°–º–∞—Ä—Ç—Ñ–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–µ–±—è..." },
                social: { title: "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏", text: "–í–∞—à —Å–º–∞—Ä—Ç—Ñ–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–∞—Å –∏–ª–∏ –≤—ã ‚Äî –Ω–∞ –∑–∞—Ä—è–¥–∫—É? üîã..." },
                email: { title: "Email-—Ä–∞—Å—Å—ã–ª–∫–∞", text: "3 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–æ–π–¥—É—Ç—Å—è –≤–∞–º –≤ 30 000 ‚ÇΩ..." }
            }
        };

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        function generateId() {
            return Math.random().toString(36).substring(2, 10);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function init() {
            loadFromStorage();
            updatePortfolioId();
            setupEventListeners();
            renderActiveTab();
            applyTheme();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage
        function loadFromStorage() {
            const saved = localStorage.getItem('portfolioData');
            if (saved) {
                const parsed = JSON.parse(saved);
                Object.assign(state, parsed);
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
        function saveToStorage() {
            localStorage.setItem('portfolioData', JSON.stringify(state));
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ID –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        function updatePortfolioId() {
            document.getElementById('portfolio-id').textContent = `ID: ${state.portfolioId}`;
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            document.getElementById('preview-toggle').addEventListener('click', togglePreview);
            
            // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è
            document.getElementById('share-btn').addEventListener('click', sharePortfolio);
            
            // –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∞—Ç—å PDF
            document.getElementById('download-pdf').addEventListener('click', downloadPDF);
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
            document.getElementById('content-editor').addEventListener('input', (e) => {
                state.content[state.activeTab].text = e.target.value;
                saveToStorage();
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        function toggleTheme() {
            state.darkMode = !state.darkMode;
            applyTheme();
            saveToStorage();
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
        function applyTheme() {
            if (state.darkMode) {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
            } else {
                document.documentElement.removeAttribute('data-theme');
                document.getElementById('theme-toggle').textContent = 'üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞';
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        function togglePreview() {
            state.previewMode = !state.previewMode;
            renderActiveTab();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            state.content[state.activeTab].text = document.getElementById('content-editor').value;
            saveToStorage();
            
            state.activeTab = tabName;
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabName);
            });
            
            renderActiveTab();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
        function renderActiveTab() {
            const content = state.content[state.activeTab];
            const editor = document.getElementById('content-editor');
            const preview = document.getElementById('preview-content');
            const previewTitle = document.getElementById('preview-title');
            const previewText = document.getElementById('preview-text');
            
            if (state.previewMode) {
                editor.style.display = 'none';
                preview.style.display = 'block';
                previewTitle.textContent = content.title;
                previewText.textContent = content.text;
                document.getElementById('preview-toggle').textContent = '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';
            } else {
                editor.style.display = 'block';
                preview.style.display = 'none';
                editor.value = content.text;
                editor.placeholder = `–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è ${content.title.toLowerCase()}...`;
                document.getElementById('preview-toggle').textContent = 'üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä';
            }
        }

        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏)
        function sharePortfolio() {
            state.content[state.activeTab].text = document.getElementById('content-editor').value;
            saveToStorage();
            
            const shareData = {
                id: state.portfolioId,
                content: state.content,
                timestamp: new Date().toISOString()
            };
            
            const encodedData = btoa(JSON.stringify(shareData));
            const shareUrl = `${window.location.origin}${window.location.pathname}#${encodedData}`;
            
            navigator.clipboard.writeText(shareUrl).then(() => {
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }).catch(err => {
                showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', true);
                console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ PDF —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pdfmake
        function downloadPDF() {
            state.content[state.activeTab].text = document.getElementById('content-editor').value;
            saveToStorage();
            
            // –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pdfmake
            const documentDefinition = {
                content: [
                    { text: '–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∫–æ–ø–∏—Ä–∞–π—Ç–µ—Ä–∞', style: 'header' },
                    { text: `ID: ${state.portfolioId}`, style: 'subheader' },
                    { text: `–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: ${new Date().toLocaleDateString()}`, style: 'subheader' },
                    { text: '', margin: [0, 15, 0, 0] },
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
                    ...Object.values(state.content).map(item => ([
                        { text: item.title, style: 'sectionHeader' },
                        { text: item.text, style: 'content' },
                        { text: '', margin: [0, 10, 0, 0] }
                    ])).flat(),
                    
                    { text: '', margin: [0, 20, 0, 0] },
                    { text: '–û–Ω–ª–∞–π–Ω-–≤–µ—Ä—Å–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ', style: 'sectionHeader' },
                    { text: window.location.href, style: 'link', link: window.location.href }
                ],
                styles: {
                    header: {
                        fontSize: 18,
                        bold: true,
                        margin: [0, 0, 0, 10]
                    },
                    subheader: {
                        fontSize: 12,
                        margin: [0, 0, 0, 5]
                    },
                    sectionHeader: {
                        fontSize: 14,
                        bold: true,
                        margin: [0, 10, 0, 5]
                    },
                    content: {
                        fontSize: 12,
                        margin: [0, 0, 0, 10]
                    },
                    link: {
                        fontSize: 10,
                        color: 'blue',
                        margin: [0, 0, 0, 5]
                    }
                },
                defaultStyle: {
                    font: 'Roboto'
                }
            };
            
            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º PDF
            pdfMake.createPdf(documentDefinition).download(`portfolio-${state.portfolioId}.pdf`);
            showNotification('PDF —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = isError ? 'notification error' : 'notification';
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ö–µ—à–∞ URL
        function loadFromHash() {
            if (window.location.hash) {
                try {
                    const hash = window.location.hash.substring(1);
                    const decoded = JSON.parse(atob(hash));
                    
                    if (decoded.id && decoded.content) {
                        state.portfolioId = decoded.id;
                        state.content = decoded.content;
                        updatePortfolioId();
                        renderActiveTab();
                        showNotification('–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ —Å—Å—ã–ª–∫–∏!');
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ —Ö–µ—à–∞:', e);
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            init();
            loadFromHash();
        });

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            state.content[state.activeTab].text = document.getElementById('content-editor').value;
            saveToStorage();
        });
    </script>
</body>
</html>